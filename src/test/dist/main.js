/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/lib/EllipsisBlock.js":
/*!**********************************!*\
  !*** ./src/lib/EllipsisBlock.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass EllipsisBlock {\r\n    type = undefined;\r\n    name = undefined;\r\n    id = undefined;\r\n    showExpanded = false;\r\n    obj = undefined;\r\n    availability = undefined;\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (EllipsisBlock);\n\n//# sourceURL=webpack://ellipsis-folders/./src/lib/EllipsisBlock.js?");

/***/ }),

/***/ "./src/lib/EllipsisDrive.js":
/*!**********************************!*\
  !*** ./src/lib/EllipsisDrive.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _EllipsisBlock_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EllipsisBlock.js */ \"./src/lib/EllipsisBlock.js\");\n/* harmony import */ var _EllipsisFolder_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EllipsisFolder.js */ \"./src/lib/EllipsisFolder.js\");\n\r\n\r\n\r\nclass EllipsisDrive {\r\n  BLUE = \"#089EC8\";\r\n  GRAY = \"rgba(0, 0, 0, 0.87)\";\r\n  SVGGRAY = \"rgba(0, 0, 0, 0.54)\";\r\n\r\n  APIURL = \"https://api.ellipsis-drive.com/v3\";\r\n\r\n\r\n  DEPTHFACTOR = 30;\r\n  DEPTHCONSTANT = 0;\r\n\r\n\r\n  isValidTimestamp = (t) => {\r\n    if (t.status !== 'active') {\r\n      return { available: false, reason: 'Timestamp not active' };\r\n    } else if (t.availability.blocked) {\r\n      return { available: false, reason: t.availability.reason };\r\n    }\r\n    return { available: true };\r\n  };\r\n  \r\n  isValidMap = (m) => {\r\n    if (!m) {\r\n      return { available: false, reason: 'No Layer' };\r\n    }\r\n    if (m.type !== 'raster' && m.type !== 'vector') {\r\n      return { available: true };\r\n    }\r\n    if (m.disabled) {\r\n      return { available: false, reason: 'Layer disabled' };\r\n    }\r\n    if (m.deleted) {\r\n      return { available: false, reason: 'Layer trashed' };\r\n    }\r\n    if (m.yourAccess.accessLevel === 0) {\r\n      return { available: false, reason: 'No access' };\r\n    }\r\n    if (m[m.type].timestamps.filter((t) => this.isValidTimestamp(t, m).available).length === 0) {\r\n      if (m[m.type].timestamps.find((t) => t.availability?.reason === 'relocation')) {\r\n        return { available: false, reason: 'Relocating layer' };\r\n      } else if (m[m.type].timestamps.find((t) => t.availability?.reason === 'reindexing')) {\r\n        return { available: false, reason: 'Reindexing layer' };\r\n      } else if (m.type === 'raster' && m[m.type].timestamps.filter((t) => t.uploads.completed > 0).length === 0) {\r\n        return { available: false, reason: 'No uploads' };\r\n      } else if (m[m.type].timestamps.find((t) => t.status === 'activating')) {\r\n        return { available: false, reason: 'Activating files' };\r\n      } else if (m[m.type].timestamps.find((t) => t.status === 'pausing')) {\r\n        return { available: false, reason: 'Pausing files' };\r\n      } else if (m[m.type].timestamps.find((t) => t.status === 'created')) {\r\n        return { available: false, reason: 'No active timestamps' };\r\n      } else {\r\n        return { available: false, reason: 'No timestamps' };\r\n      }\r\n    }\r\n    return { available: true };\r\n  };\r\n\r\n  debounce = (func, timeout = 300) => {\r\n    let timer;\r\n    return (...args) => {\r\n      clearTimeout(timer);\r\n      timer = setTimeout(() => {\r\n        func.apply(this, args);\r\n      }, timeout);\r\n    };\r\n  };\r\n\r\n  arrowDown = (depth = 0) => {\r\n    const svg1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svg1.innerHTML = `<svg focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M7 10l5 5 5-5z\"></path></svg>`;\r\n    svg1.style.fill = this.SVGGRAY;\r\n    svg1.style.height = \"15px\";\r\n    svg1.style.width = \"15px\";\r\n    svg1.style.cursor = \"pointer\";\r\n    svg1.style.transition = \"transform 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms\";\r\n    svg1.style.marginLeft = `${\r\n      this.DEPTHCONSTANT + this.DEPTHFACTOR * depth\r\n    }px`;\r\n    svg1.classList.add(\"ellipsis-folder-arrow-down\");\r\n    return svg1;\r\n  };\r\n\r\n  arrowRight = (depth = 0) => {\r\n    let elem = this.arrowDown(depth);\r\n    elem.classList.remove(\"ellipsis-folder-arrow-down\");\r\n    elem.classList.add(\"ellipsis-folder-arrow-right\");\r\n    elem.style.transform = \"rotate(-90deg)\";\r\n    return elem;\r\n  };\r\n\r\n  refreshSVG = (depth = 0) => {\r\n    const svg1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svg1.innerHTML = `\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" enable-background=\"new 0 0 65 65\" y=\"0px\" x=\"0px\" viewBox=\"0 0 65 65\">\r\n        <path d=\"m32.5 4.999c-5.405 0-10.444 1.577-14.699 4.282l-5.75-5.75v16.11h16.11l-6.395-6.395c3.18-1.787 6.834-2.82 10.734-2.82 12.171 0 22.073 9.902 22.073 22.074 0 2.899-0.577 5.664-1.599 8.202l4.738 2.762c1.47-3.363 2.288-7.068 2.288-10.964 0-15.164-12.337-27.501-27.5-27.501z\"/>\r\n        <path d=\"m43.227 51.746c-3.179 1.786-6.826 2.827-10.726 2.827-12.171 0-22.073-9.902-22.073-22.073 0-2.739 0.524-5.35 1.439-7.771l-4.731-2.851c-1.375 3.271-2.136 6.858-2.136 10.622 0 15.164 12.336 27.5 27.5 27.5 5.406 0 10.434-1.584 14.691-4.289l5.758 5.759v-16.112h-16.111l6.389 6.388z\"/>\r\n      </svg>`;\r\n    svg1.style.height = \"15px\";\r\n    svg1.style.width = \"15px\";\r\n    svg1.style.cursor = \"pointer\";\r\n    svg1.setAttribute(\"viewBox\", \"0 0 24 24\");\r\n    svg1.style.fill = this.BLUE;\r\n    //svg1.style.marginLeft = this.DEPTHFACTOR * depth;\r\n    return svg1;\r\n  };\r\n\r\n  getFolderSVG = (id, depth = 0) => {\r\n    const svg1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svg1.style.height = \"23px\";\r\n    svg1.style.width = \"23px\";\r\n    svg1.style.position = \"relative\";\r\n    svg1.style.bottom = \"5px\";\r\n    svg1.style.fill = this.SVGGRAY;\r\n    svg1.style.cursor = \"pointer\";\r\n    svg1.style.marginLeft = `${\r\n      this.DEPTHCONSTANT + this.DEPTHFACTOR * depth + 10\r\n    }px`;\r\n    svg1.style.float = \"left\";\r\n    svg1.classList.add(\"ellipsis-folder-icon\");\r\n\r\n    switch (id) {\r\n      case \"myDrive\":\r\n        svg1.innerHTML = `<svg focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M11.09 5.37516C10.71 4.99516 10.2 4.78516 9.67 4.78516H4.5C3.4 4.78516 2.51 5.68516 2.51 6.78516L2.5 18.7852C2.5 19.8852 3.4 20.7852 4.5 20.7852H20.5C21.6 20.7852 22.5 19.8852 22.5 18.7852V8.78516C22.5 7.68516 21.6 6.78516 20.5 6.78516H12.5L11.09 5.37516ZM15.502 16.8819C14.7572 16.8818 14.0374 16.6134 13.4745 16.1257C12.9116 15.6381 12.5433 14.9641 12.4372 14.227H15.502V13.3459H12.4372C12.5136 12.8141 12.727 12.3113 13.0566 11.8869C13.3862 11.4626 13.8205 11.1313 14.317 10.9256C14.8135 10.7199 15.355 10.6469 15.8882 10.7138C16.4214 10.7807 16.9281 10.9852 17.3583 11.3072L18.0025 10.6632C17.4141 10.192 16.7045 9.89662 15.9555 9.81103C15.2065 9.72545 14.4485 9.85315 13.769 10.1794C13.0894 10.5057 12.5158 11.0173 12.1144 11.6552C11.713 12.2932 11.5 13.0315 11.5 13.7852C11.5 14.5388 11.713 15.2772 12.1144 15.9151C12.5158 16.553 13.0894 17.0646 13.769 17.3909C14.4485 17.7172 15.2065 17.8449 15.9555 17.7593C16.7045 17.6737 17.4141 17.3783 18.0025 16.9071L17.3583 16.2632C16.8232 16.6655 16.1716 16.8827 15.502 16.8819ZM17.9847 15.6338C18.3836 15.1005 18.5989 14.4524 18.5983 13.7865C18.5996 13.1212 18.3854 12.4735 17.9878 11.9401C17.9861 11.9379 17.9852 11.9353 17.9852 11.9325C17.9852 11.9298 17.9861 11.9271 17.9878 11.925L18.6125 11.2983C18.6136 11.297 18.615 11.2961 18.6165 11.2954C18.618 11.2947 18.6197 11.2944 18.6214 11.2944C18.623 11.2944 18.6247 11.2947 18.6262 11.2954C18.6277 11.2961 18.6291 11.297 18.6302 11.2983C19.1934 12.0058 19.5 12.8832 19.5 13.7874C19.5 14.6915 19.1934 15.569 18.6302 16.2764C18.6291 16.2777 18.6277 16.2787 18.6262 16.2794C18.6247 16.28 18.623 16.2804 18.6214 16.2804C18.6197 16.2804 18.618 16.28 18.6165 16.2794C18.615 16.2787 18.6136 16.2777 18.6125 16.2764L17.9847 15.6489C17.983 15.6467 17.9821 15.6441 17.9821 15.6413C17.9821 15.6386 17.983 15.6359 17.9847 15.6338Z\"></path></svg>`;\r\n        break;\r\n      case \"sharedWithMe\":\r\n        svg1.innerHTML = `<svg focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-5 3c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm4 8h-8v-1c0-1.33 2.67-2 4-2s4 .67 4 2v1z\"></path></svg>`;\r\n        break;\r\n      case \"favorites\":\r\n        svg1.innerHTML = `<svg focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-2.06 11L15 15.28 12.06 17l.78-3.33-2.59-2.24 3.41-.29L15 8l1.34 3.14 3.41.29-2.59 2.24.78 3.33z\"></path></svg>`;\r\n        break;\r\n      default:\r\n        svg1.innerHTML = `<svg focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z\"></path></svg>`;\r\n    }\r\n    return svg1;\r\n  };\r\n\r\n  getVectorSVG = (depth) => {\r\n    let div = document.createElement(\"div\");\r\n    div.style.backgroundColor = \"#3F51B5\";\r\n    div.style.borderRadius = \"50%\";\r\n    div.style.height = \"20px\";\r\n    div.style.width = \"20px\";\r\n    div.style.alignItems = \"center\";\r\n    div.style.display = \"flex\";\r\n    div.style.float = \"left\";\r\n    div.style.marginLeft = `${this.DEPTHFACTOR * (depth-1) + 57}px`;\r\n\r\n    const svg1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svg1.style.height = \"15px\";\r\n    svg1.style.cursor = \"pointer\";\r\n    svg1.style.float = \"left\";\r\n    svg1.classList.add(\"ellipsis-vector-icon\");\r\n    svg1.innerHTML = `<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"draw-polygon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><path fill=\"#FFFFFF\" d=\"M384 352c-.35 0-.67.1-1.02.1l-39.2-65.32c5.07-9.17 8.22-19.56 8.22-30.78s-3.14-21.61-8.22-30.78l39.2-65.32c.35.01.67.1 1.02.1 35.35 0 64-28.65 64-64s-28.65-64-64-64c-23.63 0-44.04 12.95-55.12 32H119.12C108.04 44.95 87.63 32 64 32 28.65 32 0 60.65 0 96c0 23.63 12.95 44.04 32 55.12v209.75C12.95 371.96 0 392.37 0 416c0 35.35 28.65 64 64 64 23.63 0 44.04-12.95 55.12-32h209.75c11.09 19.05 31.49 32 55.12 32 35.35 0 64-28.65 64-64 .01-35.35-28.64-64-63.99-64zm-288 8.88V151.12A63.825 63.825 0 0 0 119.12 128h208.36l-38.46 64.1c-.35-.01-.67-.1-1.02-.1-35.35 0-64 28.65-64 64s28.65 64 64 64c.35 0 .67-.1 1.02-.1l38.46 64.1H119.12A63.748 63.748 0 0 0 96 360.88zM272 256c0-8.82 7.18-16 16-16s16 7.18 16 16-7.18 16-16 16-16-7.18-16-16zM400 96c0 8.82-7.18 16-16 16s-16-7.18-16-16 7.18-16 16-16 16 7.18 16 16zM64 80c8.82 0 16 7.18 16 16s-7.18 16-16 16-16-7.18-16-16 7.18-16 16-16zM48 416c0-8.82 7.18-16 16-16s16 7.18 16 16-7.18 16-16 16-16-7.18-16-16zm336 16c-8.82 0-16-7.18-16-16s7.18-16 16-16 16 7.18 16 16-7.18 16-16 16z\"></path></svg>`;\r\n    div.appendChild(svg1);\r\n    return div;\r\n  };\r\n\r\n  getRasterSVG = (depth) => {\r\n    let div = document.createElement(\"div\");\r\n    div.style.backgroundColor = \"#00796B\";\r\n    div.style.borderRadius = \"50%\";\r\n    div.style.height = \"20px\";\r\n    div.style.width = \"20px\";\r\n    div.style.alignItems = \"center\";\r\n    div.style.display = \"flex\";\r\n    div.style.float = \"left\";\r\n    div.style.marginLeft = `${this.DEPTHFACTOR * (depth-1) + 57}px`;\r\n\r\n    const svg1 = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\r\n    svg1.style.height = \"15px\";\r\n    svg1.style.fill = \"#FFFFFF\";\r\n    svg1.style.cursor = \"pointer\";\r\n    svg1.style.float = \"left\";\r\n    svg1.classList.add(\"ellipsis-raster-icon\");\r\n    svg1.innerHTML = `<svg focusable=\"false\" viewBox=\"0 0 24 24\" aria-hidden=\"true\"><path d=\"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z\"></path></svg>`;\r\n    div.appendChild(svg1);\r\n    return div;\r\n  };\r\n\r\n  authError = false;\r\n\r\n  defaultSettings = {\r\n    loggedIn: false,\r\n    token: null,\r\n    types: \"\",\r\n    cb: (data) => {\r\n      console.log(\r\n        \"Default callback is called, please provide your own callback!\"\r\n      );\r\n    },\r\n    icon: \"default\",\r\n    div: null,\r\n    showRaster: true,\r\n    showVector: true,\r\n    searchIncludeFolders: true,\r\n    preloadRoots: false,\r\n  };\r\n\r\n  settings = {};\r\n\r\n  constructor(options = {}) {\r\n    // root of the folder structure\r\n    this.root = {\r\n      name: \"ellipsis-folder-root\",\r\n      text: \"ellipsis-folder-root\",\r\n      id: \"ellipsis-folder-root\",\r\n      trueRoot: true,\r\n      showExpanded: true,\r\n      foldersExpanded: true,\r\n      folders: [\r\n        new _EllipsisFolder_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](\"My Drive\", \"myDrive\", \"myDrive\", 0, true),\r\n        new _EllipsisFolder_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](\"Shared with me\", \"sharedWithMe\", \"sharedWithMe\", 0, true),\r\n        new _EllipsisFolder_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](\"Favorites\", \"favorites\", \"favorites\", 0, true),\r\n      ],\r\n      blocks: [],\r\n    };\r\n\r\n    this.settings = { ...this.defaultSettings, ...options };\r\n\r\n    this.searching = false;\r\n    this.activeSearch = false;\r\n    this.searchString = \"\";\r\n\r\n    this.searchResults = [];\r\n\r\n    if (!(\"div\" in options)) {\r\n      console.warn(\"EllipsisDrive: no div is provided!\");\r\n      return;\r\n    }\r\n\r\n    if (\"token\" in options) {\r\n      this.settings.token = options.token;\r\n      this.settings.loggedIn = true;\r\n    } else {\r\n      // find out if there's a token for us in the url\r\n      const queryString = window.location.search;\r\n      const urlParams = new URLSearchParams(queryString);\r\n      if (urlParams.has(\"token\")) {\r\n        this.settings.token = urlParams.get(\"token\");\r\n        this.settings.loggedIn = true;\r\n      }\r\n    }\r\n\r\n    this.searchBarDiv = this.getSearchBar();\r\n    this.normalDiv = document.createElement(\"div\");\r\n\r\n    this.searchBarDiv.setAttribute(\"id\", \"ellipsis-drive-searchbar\");\r\n    this.normalDiv.setAttribute(\"id\", \"ellipsis-drive-explorer\");\r\n\r\n    this.settings.div.style.backgroundColor = \"#f5f5f5\";\r\n    this.settings.div.style.overflow = \"scroll\";\r\n\r\n    this.settings.div.appendChild(this.searchBarDiv);\r\n    this.settings.div.appendChild(this.normalDiv);\r\n\r\n    if (this.settings.preloadRoots){\r\n      // experimental feature, already load in the first 'layer' in the file structure so there is not loading time there\r\n      for (const folder of this.root.folders){\r\n        this.expandFolder(folder);\r\n      }\r\n    }\r\n\r\n    this.render();\r\n  }\r\n\r\n  bouncingOnClick = (folder, input) => {\r\n    folder.showExpanded = !folder.showExpanded;\r\n    this.render();\r\n  };\r\n\r\n  onClick = this.debounce(this.bouncingOnClick, 100);\r\n\r\n  p = (str, depth = 0) => {\r\n    let elem = document.createElement(\"p\");\r\n    elem.innerText = str;\r\n    elem.style.paddingLeft = `${\r\n      this.DEPTHCONSTANT + this.DEPTHFACTOR * depth + 40\r\n    }px`;\r\n    elem.classList.add(\"ellipsis-folder-p\");\r\n    elem.style.fontFamily = `\"Roboto Condensed\",\"Roboto\",\"Helvetica\",\"Lucida Sans Unicode\",\"sans-serif\"`;\r\n    elem.style.cursor = \"default\";\r\n    return elem;\r\n  };\r\n\r\n  /**\r\n   * @param {EllipsisFolder}\r\n   * @param {string} either \"folder\" or \"map\"\r\n   */\r\n  getListFolder = async (folder, isFolder, isRoot = false) => {\r\n    let url = \"\";\r\n    let headers = {};\r\n\r\n    if (isRoot){\r\n      url = `${this.APIURL}/account/root/${folder.id}?&isFolder=${isFolder}`\r\n    } else {\r\n      url = `${this.APIURL}/path/${folder.id}/list?isFolder=${isFolder}`\r\n    }\r\n\r\n    headers = {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${this.settings.token}`,\r\n    };\r\n\r\n    let request = await fetch(url, {\r\n      method: \"GET\",\r\n      headers: headers,\r\n    });\r\n\r\n    return request.json();\r\n  };\r\n\r\n  fixFolder = (inputFolder) => {\r\n    // we might also just return inputFolder but add the 'text' field\r\n    let folder = new _EllipsisFolder_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\r\n    folder.name = inputFolder.name;\r\n    folder.id = inputFolder.id;\r\n    folder.text = inputFolder.name;\r\n    folder.obj = inputFolder;\r\n    return folder;\r\n  };\r\n\r\n  fixBlock = (inputBlock) => {\r\n    let block = new _EllipsisBlock_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\n    block.type = inputBlock.type;\r\n    block.id = inputBlock.id;\r\n    block.name = inputBlock.name;\r\n    block.obj = inputBlock;\r\n\r\n    block.availability = this.isValidMap(inputBlock);\r\n\r\n    return block;\r\n  };\r\n\r\n  expandFolder = (folder) => {\r\n    folder.foldersExpanded = true;\r\n    let isRoot = folder.root;\r\n    let folders = this.getListFolder(folder, true, isRoot);\r\n    let blocks = this.getListFolder(folder, false, isRoot);\r\n    Promise.all([folders, blocks]).then((values) => {\r\n      if (!(\"result\" in values[0])) {\r\n        console.warn(\r\n          \"EllipsisDrive: Authentication error, your token might be invalid\"\r\n        );\r\n        this.render();\r\n        return;\r\n      }\r\n      folder.folders = values[0].result.map(this.fixFolder);\r\n      folder.blocks = values[1].result.map(this.fixBlock);\r\n      folder.folders.map((childfolder) => {\r\n        childfolder.depth = folder.depth + 1;\r\n      });\r\n      folder.blocks.map((childblock) => {\r\n        childblock.depth = folder.depth + 1;\r\n      });\r\n      this.render();\r\n    });\r\n  };\r\n\r\n  \r\n  attachMouseEnter = (div, elems, svgs, refresh) => {\r\n    for (const elem of elems){\r\n      elem.style.color = this.GRAY;\r\n      elem.style.cursor = \"pointer\";\r\n    }\r\n\r\n    if (!svgs) {\r\n      svgs = [];\r\n    }\r\n\r\n    let turnColor = (color, svgcolor, onEnter) => {\r\n      let func = () => {\r\n        if (refresh != null) {\r\n          if (onEnter) {\r\n            refresh.style.display = \"initial\";\r\n          } else {\r\n            refresh.style.display = \"none\";\r\n          }\r\n        }\r\n\r\n        for (const elem of elems){\r\n          elem.style.color = color;\r\n        }\r\n\r\n        if (refresh != null) {\r\n          refresh.style.color = svgcolor;\r\n        }\r\n\r\n        for (const svg of svgs) {\r\n          svg.style.fill = svgcolor;\r\n        }\r\n      };\r\n      return func;\r\n    };\r\n\r\n    if (div) div.onmouseenter = turnColor(this.BLUE, this.BLUE, true);\r\n    if (div) div.onmouseleave = turnColor(this.GRAY, this.SVGGRAY, false);\r\n  };\r\n\r\n  renderBlock = (block, search=false) => {\r\n\r\n    if (search){\r\n      block.depth = 0;\r\n    }\r\n\r\n    let available = block.availability.available;\r\n    \r\n    let div = document.createElement(\"div\");\r\n\r\n    if ((block.type == \"raster\" && !this.settings.showRaster) || (block.type == \"vector\" && !this.settings.showVector)) {\r\n      div.style.display = \"none\";\r\n    }\r\n\r\n    let p1 = this.p(`${block.name}`, block.depth);\r\n    let p2 = undefined;\r\n\r\n    if (available){\r\n      p2 = this.p(`${block.type}`, block.depth);\r\n    }\r\n    else \r\n    {\r\n      p1.style.color = \"gray\";\r\n      p2 = this.p(`${block.availability.reason}`, block.depth);\r\n    }\r\n\r\n    p2.style.color = \"gray\";\r\n    p2.style.marginLeft = \"20px\";\r\n    p2.style.marginTop = \"-15px\";\r\n    p1.style.marginLeft = \"20px\";\r\n\r\n    let icon =\r\n      block.type == \"raster\"\r\n        ? this.getRasterSVG(block.depth)\r\n        : this.getVectorSVG(block.depth);\r\n\r\n    \r\n    let func = () => {\r\n      this.settings.cb(block.obj);\r\n    };\r\n\r\n    if (available){\r\n      this.attachMouseEnter(div, [p1,p2], [icon], null);\r\n      div.onclick = func;\r\n    } else {\r\n      icon.style.backgroundColor = this.SVGGRAY;\r\n    }\r\n\r\n    icon.style.marginTop = \"8px\";\r\n\r\n    div.appendChild(icon);\r\n    div.appendChild(p1);\r\n    div.appendChild(p2);\r\n\r\n    return div;\r\n  };\r\n\r\n  renderFolder = (folder) => {\r\n    let div = document.createElement(\"div\");\r\n    div.setAttribute(\"id\", `${folder.id}`);\r\n    div.classList.add(\"ellipsis-folder\");\r\n\r\n    let startdiv = document.createElement(\"div\");\r\n    startdiv.setAttribute(\"id\", `${folder.id}_start`);\r\n\r\n    let enddiv = document.createElement(\"div\");\r\n    enddiv.setAttribute(\"id\", `${folder.id}_end`);\r\n\r\n    div.appendChild(startdiv);\r\n    div.appendChild(enddiv);\r\n\r\n    if (!folder.trueRoot) {\r\n      startdiv.onclick = (input) => this.onClick(folder, input);\r\n      let toBeAdded = this.p(`${folder.text}`, folder.depth);\r\n      toBeAdded.style.marginLeft = \"20px\";\r\n\r\n      let arrow = folder.showExpanded\r\n        ? this.arrowDown(folder.depth)\r\n        : this.arrowRight(folder.depth);\r\n\r\n      let refresh = this.refreshSVG();\r\n      refresh.onclick = () => {\r\n        folder.showExpanded = !folder.showExpanded;\r\n        folder.foldersExpanded = false;\r\n        folder.folders = [];\r\n        folder.blocks = [];\r\n      };\r\n\r\n      let foldericon = this.getFolderSVG(folder.id);\r\n      this.attachMouseEnter(startdiv, [toBeAdded], [arrow, foldericon], refresh);\r\n\r\n      refresh.style.float = \"right\";\r\n      refresh.style.position = \"relative\";\r\n      refresh.style.display = \"none\";\r\n\r\n      arrow.style.float = \"left\";\r\n      startdiv.appendChild(arrow);\r\n      startdiv.appendChild(foldericon);\r\n      startdiv.appendChild(refresh);\r\n      startdiv.appendChild(toBeAdded);\r\n    }\r\n\r\n    // if a folder should be expanded, but is not yet: expand it\r\n    if (folder.showExpanded && !folder.foldersExpanded) {\r\n      let loading = this.p(\"Loading...\", folder.depth + 1);\r\n      div.insertBefore(loading, enddiv);\r\n      this.expandFolder(folder);\r\n    }\r\n\r\n    // an expanded folder should show its content\r\n    if (folder.showExpanded) {\r\n      for (const subfolder of folder.folders) {\r\n        div.insertBefore(this.renderFolder(subfolder), enddiv);\r\n      }\r\n      for (const block of folder.blocks) {\r\n        div.insertBefore(this.renderBlock(block), enddiv);\r\n      }\r\n      if (folder.folders.length == 0 && folder.blocks.length == 0) {\r\n        // empty folder\r\n      }\r\n    }\r\n    return div;\r\n  };\r\n\r\n  getButton = (text, cb) => {\r\n    let button = document.createElement(\"button\");\r\n    button.onclick = cb;\r\n    button.innerHTML = text;\r\n    button.style.color = \"#fff\";\r\n    button.style.backgroundColor = \"#089EC8\";\r\n    button.style.boxShadow =\r\n      \"0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12)\";\r\n    button.style.padding = \"6px 16px\";\r\n    button.style.fontSize = \"1rem\";\r\n    button.style.minWidth = \"64px\";\r\n    button.style.boxSizing = \"border-box\";\r\n    button.style.transition = `\"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms`;\r\n    button.style.fontFamily = [\r\n      \"Roboto Condensed\",\r\n      \"Roboto\",\r\n      \"-apple-system\",\r\n      \"BlinkMacSystemFont\",\r\n      \"Segoe UI\",\r\n      \"Helvetica Neue\",\r\n      \"Arial\",\r\n      \"sans-serif\",\r\n      \"Apple Color Emoji\",\r\n      \"Segoe UI Emoji\",\r\n      \"Segoe UI Symbol\",\r\n      \"Exo 2\",\r\n    ];\r\n    button.style.fontWeight = \"500\";\r\n    button.style.lineHeight = \"1.75\";\r\n    button.style.borderRadius = \"4px\";\r\n    button.style.letterSpacing = \"0.5px\";\r\n    button.style.textTransform = \"uppercase\";\r\n    button.style.border = 0;\r\n    return button;\r\n  };\r\n\r\n  loginDiv = () => {\r\n    let div = document.createElement(\"div\");\r\n    div.appendChild(this.p(\"Please log in to your Ellipsis Drive account:\"));\r\n    div.style.textAlign = \"center\";\r\n    let button = this.getButton(\"Log in\", () => {\r\n      window.location = `https://app.ellipsis-drive.com/login?referer=${window.location.href}`;\r\n    });\r\n    div.appendChild(button);\r\n    return div;\r\n  };\r\n\r\n  authErrorDiv = () => {\r\n    let div = document.createElement(\"div\");\r\n    div.appendChild(\r\n      this.p(\"Authentication error, please check if token is correct\")\r\n    );\r\n    div.style.textAlign = \"center\";\r\n\r\n    let button = this.getButton(\"Retry\", () => {\r\n      this.render();\r\n    });\r\n    console.warn(`Authentication error, token used is: ${this.settings.token}`);\r\n    div.appendChild(button);\r\n    return div;\r\n  };\r\n\r\n  renderSearch = () => {\r\n    let div = document.createElement(\"div\");\r\n    if (this.activeSearch) {\r\n      let p = this.p(\"Loading..\");\r\n      div.appendChild(p);\r\n    } else {\r\n      let anything = false;\r\n\r\n      if (this.settings.searchIncludeFolders) {\r\n        for (const folder of this.searchResults[0]) {\r\n          anything = true;\r\n          div.appendChild(this.renderFolder(folder));\r\n        }\r\n      }\r\n\r\n      if (this.settings.showRaster) {\r\n        for (const block of this.searchResults[1]) {\r\n          anything = true;\r\n          div.appendChild(this.renderBlock(block, true));\r\n        }\r\n      }\r\n\r\n      if (this.settings.showVector) {\r\n        for (const block of this.searchResults[2]) {\r\n          anything = true;\r\n          div.appendChild(this.renderBlock(block, true));\r\n        }\r\n      }\r\n\r\n      if (!anything) {\r\n        div.appendChild(this.p(\"No results found\"));\r\n      }\r\n    }\r\n    return div;\r\n  };\r\n\r\n  performSearch = async (text) => {\r\n\r\n    let apiurl = `${this.APIURL}/path`\r\n\r\n    let folderurl = `${apiurl}?type=[\"folder\"]&name=${text}`;\r\n    let vectorurl = `${apiurl}?type=[\"vector\"]&name=${text}`;\r\n    let rasterurl = `${apiurl}?type=[\"raster\"]&name=${text}`;\r\n\r\n    let urls = [folderurl, vectorurl, rasterurl];\r\n\r\n    let requests = [];\r\n\r\n    let headers = {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${this.settings.token}`,\r\n    };\r\n\r\n    for (const url of urls) {\r\n      requests.push(\r\n        fetch(url, {\r\n          method: \"GET\",\r\n          headers: headers,\r\n        })\r\n      );\r\n    }\r\n\r\n    Promise.all(requests)\r\n      .then((ret) => {\r\n        let json = [];\r\n        for (const prom of ret) {\r\n          json.push(prom.json());\r\n        }\r\n        return Promise.all(json);\r\n      })\r\n      .then((ret) => {\r\n        this.searchResults = [\r\n          ret[0].result.map(this.fixFolder),\r\n          ret[1].result.map(this.fixBlock),\r\n          ret[2].result.map(this.fixBlock),\r\n        ];\r\n        this.activeSearch = false;\r\n        this.render();\r\n      });\r\n  };\r\n\r\n  bouncingOnSearchChange = (input) => {\r\n    let str = input.target.value;\r\n    this.searchString = str;\r\n\r\n    if (str == \"\") {\r\n      this.searching = false;\r\n      this.activeSearch = false;\r\n    } else {\r\n      this.searching = true;\r\n      this.activeSearch = true;\r\n\r\n      this.performSearch(this.searchString);\r\n    }\r\n    this.render();\r\n  };\r\n\r\n  onSearchChange = this.debounce(this.bouncingOnSearchChange, 200);\r\n\r\n  getSearchBar = () => {\r\n    let div = document.createElement(\"div\");\r\n    let search = document.createElement(\"input\");\r\n    search.setAttribute(\"id\", \"ellipsis-drive-search\");\r\n    search.style.marginLeft = `${this.DEPTHCONSTANT}px`;\r\n    search.type = \"text\";\r\n    search.placeholder = \"Search Drive\";\r\n    search.value = this.searchString;\r\n    search.addEventListener(\"input\", this.onSearchChange);\r\n    search.style.width = \"80%\";\r\n    search.style.left = \"20px\";\r\n    search.style.position = \"relative\";\r\n    div.appendChild(search);\r\n    return div;\r\n  };\r\n\r\n  render = () => {\r\n    this.normalDiv.innerHTML = \"\";\r\n\r\n    if (!this.settings.loggedIn) {\r\n      this.searchBarDiv.style.display = \"none\";\r\n      this.normalDiv.appendChild(this.loginDiv());\r\n    } else if (this.authError) {\r\n      this.normalDiv.appendChild(this.authErrorDiv());\r\n    } else {\r\n      this.searchBarDiv.style.display = \"initial\";\r\n      if (this.searching) {\r\n        this.normalDiv.appendChild(this.renderSearch());\r\n      } else {\r\n        this.normalDiv.appendChild(this.renderFolder(this.root));\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (EllipsisDrive);\r\n\n\n//# sourceURL=webpack://ellipsis-folders/./src/lib/EllipsisDrive.js?");

/***/ }),

/***/ "./src/lib/EllipsisFolder.js":
/*!***********************************!*\
  !*** ./src/lib/EllipsisFolder.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass EllipsisFolder {\r\n    folders = [];\r\n    blocks = [];\r\n    text = undefined;\r\n    name = undefined;\r\n    id = undefined;\r\n    root = false;\r\n    showExpanded = false;\r\n    foldersExpanded = false;\r\n    trueRoot = false;\r\n    depth = 0;\r\n  \r\n    constructor(text, name, id, depth = 0, root = false) {\r\n      this.text = text;\r\n      this.name = name;\r\n      this.id = id;\r\n      this.root = root;\r\n      this.blocks = [];\r\n      this.folders = [];\r\n      this.depth = depth;\r\n    }\r\n  }\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (EllipsisFolder);\n\n//# sourceURL=webpack://ellipsis-folders/./src/lib/EllipsisFolder.js?");

/***/ }),

/***/ "./src/lib/index.js":
/*!**************************!*\
  !*** ./src/lib/index.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"EllipsisDrive\": () => (/* reexport safe */ _EllipsisDrive__WEBPACK_IMPORTED_MODULE_0__[\"default\"])\n/* harmony export */ });\n/* harmony import */ var _EllipsisDrive__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EllipsisDrive */ \"./src/lib/EllipsisDrive.js\");\n\r\n\r\n\n\n//# sourceURL=webpack://ellipsis-folders/./src/lib/index.js?");

/***/ }),

/***/ "./src/test/index.js":
/*!***************************!*\
  !*** ./src/test/index.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib */ \"./src/lib/index.js\");\n\r\n\r\n\r\nlet cb = (layer) => {\r\n    console.log(\"Clicked on layer:\");\r\n    console.log(layer);\r\n};\r\n\r\nlet div = document.getElementById(\"test\");\r\n\r\nlet options = {\r\n    div: div, \r\n    cb: cb,\r\n    searchIncludeFolders: true,\r\n    showVector: true,\r\n    showRaster: true,\r\n    allowExpandMaps: true\r\n}\r\n\r\nlet myDrive = new _lib__WEBPACK_IMPORTED_MODULE_0__.EllipsisDrive(options);\n\n//# sourceURL=webpack://ellipsis-folders/./src/test/index.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/test/index.js");
/******/ 	
/******/ })()
;